{
  "type": "json_schema",
  "schema": {
    "type": "object",
    "properties": {
      "valueFlows": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "asset": { "type": "string" },
            "path": { "type": "string" },
            "trigger": { "type": "string" }
          },
          "required": ["asset", "path", "trigger"],
          "additionalProperties": false
        }
      },
      "patterns": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "appliedTo": { "type": "string" },
            "rationale": { "type": "string" }
          },
          "required": ["name", "appliedTo", "rationale"],
          "additionalProperties": false
        }
      },
      "custodyDecisions": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "entity": { "type": "string" },
            "custody": { "type": "string" },
            "contractName": { "type": "string" },
            "rationale": { "type": "string" }
          },
          "required": ["entity", "custody", "rationale"],
          "additionalProperties": false
        }
      },
      "tokenCategories": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "id": { "type": "string" },
            "purpose": { "type": "string" },
            "capability": { "type": "string" }
          },
          "required": ["id", "purpose", "capability"],
          "additionalProperties": false
        }
      },
      "contracts": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "role": { "type": "string" },
            "lifecycle": { "type": "string" },
            "validates": { "type": "string" },
            "stateLayout": { "type": "string" }
          },
          "required": ["name", "role", "lifecycle", "validates"],
          "additionalProperties": false
        }
      },
      "transactionTemplates": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "purpose": { "type": "string" },
            "inputs": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "index": { "type": "integer" },
                  "from": { "type": "string" },
                  "type": { "type": "string" },
                  "description": { "type": "string" },
                  "required": { "type": "boolean" }
                },
                "required": ["index", "from", "type", "description", "required"],
                "additionalProperties": false
              }
            },
            "outputs": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "index": { "type": "integer" },
                  "to": { "type": "string" },
                  "type": { "type": "string" },
                  "description": { "type": "string" },
                  "changes": { "type": "string" },
                  "required": { "type": "boolean" }
                },
                "required": ["index", "to", "type", "description", "required"],
                "additionalProperties": false
              }
            }
          },
          "required": ["name", "purpose", "inputs", "outputs"],
          "additionalProperties": false
        }
      },
      "invariantEnforcement": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "invariant": { "type": "string" },
            "enforcedBy": { "type": "string" },
            "mechanism": { "type": "string" }
          },
          "required": ["invariant", "enforcedBy", "mechanism"],
          "additionalProperties": false
        }
      },
      "warnings": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "severity": { "type": "string" },
            "issue": { "type": "string" },
            "mitigation": { "type": "string" }
          },
          "required": ["severity", "issue", "mitigation"],
          "additionalProperties": false
        }
      }
    },
    "required": ["valueFlows", "patterns", "custodyDecisions", "tokenCategories", "contracts", "transactionTemplates", "invariantEnforcement", "warnings"],
    "additionalProperties": false
  }
}
